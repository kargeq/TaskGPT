(()=>{var e={187:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,s=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,s){function r(n){e.removeListener(t,o),s(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}v(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,{once:!0})}(e,r)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var i=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function l(e,t,n,s){var r,o,i,l;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),i=o[t]),void 0===i)i=o[t]=n,++e._eventsCount;else if("function"==typeof i?i=o[t]=s?[n,i]:[i,n]:s?i.unshift(n):i.push(n),(r=c(e))>0&&i.length>r&&!i.warned){i.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=i.length,l=h,console&&console.warn&&console.warn(l)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var s={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=h.bind(s);return r.listener=n,s.wrapFn=r,r}function u(e,t,n){var s=e._events;if(void 0===s)return[];var r=s[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),s=0;s<t;++s)n[s]=e[s];return n}function v(e,t,n,s){if("function"==typeof e.on)s.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){s.once&&e.removeEventListener(t,r),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)s(c,this,t);else{var l=c.length,h=p(c,l);for(n=0;n<l;++n)s(h[n],this,t)}return!0},o.prototype.addListener=function(e,t){return l(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return l(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,s,r,o,i;if(a(t),void 0===(s=this._events))return this;if(void 0===(n=s[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){i=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(s[e]=n[0]),void 0!==s.removeListener&&this.emit("removeListener",e,i||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,s;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(s=0;s<o.length;++s)"removeListener"!==(r=o[s])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},o.prototype.listeners=function(e){return u(this,e,!0)},o.prototype.rawListeners=function(e){return u(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},85:(e,t)=>{t.stringify=function e(t){if(void 0===t)return t;if(t&&Buffer.isBuffer(t))return JSON.stringify(":base64:"+t.toString("base64"));if(t&&t.toJSON&&(t=t.toJSON()),t&&"object"==typeof t){var n="",s=Array.isArray(t);n=s?"[":"{";var r=!0;for(var o in t){var i="function"==typeof t[o]||!s&&void 0===t[o];Object.hasOwnProperty.call(t,o)&&!i&&(r||(n+=","),r=!1,s?null==t[o]?n+="null":n+=e(t[o]):void 0!==t[o]&&(n+=e(o)+":"+e(t[o])))}return n+(s?"]":"}")}return"string"==typeof t?JSON.stringify(/^:/.test(t)?":"+t:t):void 0===t?"null":JSON.stringify(t)},t.parse=function(e){return JSON.parse(e,(function(e,t){return"string"==typeof t?/^:base64:/.test(t)?Buffer.from(t.substring(8),"base64"):/^:/.test(t)?t.substring(1):t:t}))}},958:(e,t,n)=>{"use strict";const s=n(187),r=n(85),o=["sqlite","postgres","mysql","mongo","redis","tiered"];e.exports=class extends s{constructor(e,{emitErrors:t=!0,...s}={}){if(super(),this.opts={namespace:"keyv",serialize:r.stringify,deserialize:r.parse,..."string"==typeof e?{uri:e}:e,...s},!this.opts.store){const e={...this.opts};this.opts.store=(e=>{const t={redis:"@keyv/redis",rediss:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql",etcd:"@keyv/etcd",offline:"@keyv/offline",tiered:"@keyv/tiered"};if(e.adapter||e.uri){const s=e.adapter||/^[^:+]*/.exec(e.uri)[0];return new(n(196)(t[s]))(e)}return new Map})(e)}if(this.opts.compression){const e=this.opts.compression;this.opts.serialize=e.serialize.bind(e),this.opts.deserialize=e.deserialize.bind(e)}"function"==typeof this.opts.store.on&&t&&this.opts.store.on("error",(e=>this.emit("error",e))),this.opts.store.namespace=this.opts.namespace;const o=e=>async function*(){for await(const[t,n]of"function"==typeof e?e(this.opts.store.namespace):e){const e=this.opts.deserialize(n);this.opts.store.namespace&&!t.includes(this.opts.store.namespace)||("number"==typeof e.expires&&Date.now()>e.expires?this.delete(t):yield[this._getKeyUnprefix(t),e.value])}};"function"==typeof this.opts.store[Symbol.iterator]&&this.opts.store instanceof Map?this.iterator=o(this.opts.store):"function"==typeof this.opts.store.iterator&&this.opts.store.opts&&this._checkIterableAdaptar()&&(this.iterator=o(this.opts.store.iterator.bind(this.opts.store)))}_checkIterableAdaptar(){return o.includes(this.opts.store.opts.dialect)||o.findIndex((e=>this.opts.store.opts.url.includes(e)))>=0}_getKeyPrefix(e){return`${this.opts.namespace}:${e}`}_getKeyPrefixArray(e){return e.map((e=>`${this.opts.namespace}:${e}`))}_getKeyUnprefix(e){return e.split(":").splice(1).join(":")}get(e,t){const{store:n}=this.opts,s=Array.isArray(e),r=s?this._getKeyPrefixArray(e):this._getKeyPrefix(e);if(s&&void 0===n.getMany){const e=[];for(const s of r)e.push(Promise.resolve().then((()=>n.get(s))).then((e=>"string"==typeof e||this.opts.compression?this.opts.deserialize(e):e)).then((e=>{if(null!=e)return"number"==typeof e.expires&&Date.now()>e.expires?this.delete(s).then((()=>{})):t&&t.raw?e:e.value})));return Promise.allSettled(e).then((e=>{const t=[];for(const n of e)t.push(n.value);return t}))}return Promise.resolve().then((()=>s?n.getMany(r):n.get(r))).then((e=>"string"==typeof e||this.opts.compression?this.opts.deserialize(e):e)).then((n=>{if(null!=n){if(s){const s=[];for(let r of n)"string"==typeof r&&(r=this.opts.deserialize(r)),null!=r?"number"==typeof r.expires&&Date.now()>r.expires?(this.delete(e).then((()=>{})),s.push(void 0)):s.push(t&&t.raw?r:r.value):s.push(void 0);return s}return"number"==typeof n.expires&&Date.now()>n.expires?this.delete(e).then((()=>{})):t&&t.raw?n:n.value}}))}set(e,t,n){const s=this._getKeyPrefix(e);void 0===n&&(n=this.opts.ttl),0===n&&(n=void 0);const{store:r}=this.opts;return Promise.resolve().then((()=>{const e="number"==typeof n?Date.now()+n:null;return"symbol"==typeof t&&this.emit("error","symbol cannot be serialized"),t={value:t,expires:e},this.opts.serialize(t)})).then((e=>r.set(s,e,n))).then((()=>!0))}delete(e){const{store:t}=this.opts;if(Array.isArray(e)){const n=this._getKeyPrefixArray(e);if(void 0===t.deleteMany){const e=[];for(const s of n)e.push(t.delete(s));return Promise.allSettled(e).then((e=>e.every((e=>!0===e.value))))}return Promise.resolve().then((()=>t.deleteMany(n)))}const n=this._getKeyPrefix(e);return Promise.resolve().then((()=>t.delete(n)))}clear(){const{store:e}=this.opts;return Promise.resolve().then((()=>e.clear()))}has(e){const t=this._getKeyPrefix(e),{store:n}=this.opts;return Promise.resolve().then((async()=>"function"==typeof n.has?n.has(t):void 0!==await n.get(t)))}disconnect(){const{store:e}=this.opts;if("function"==typeof e.disconnect)return e.disconnect()}}},196:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=196,e.exports=t}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,n),o.exports}n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";n(958);class e extends Error{constructor(e){super(e),this.name="TimeoutError"}}class t extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const s=e=>void 0===globalThis.DOMException?new t(e):new DOMException(e),r=e=>{const t=void 0===e.reason?s("This operation was aborted."):e.reason;return t instanceof Error?t:s(t)};class o extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,n)&&(yield e)}for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const s="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:s}):this._set(e,{value:t,expiry:s})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[s,r]=n;!1===this._deleteIfExpired(s,r)&&(yield[s,r.value])}this.oldCache;for(let t=e.length-1;t>=0;--t){const n=e[t],[s,r]=n;this.cache.has(s)||!1===this._deleteIfExpired(s,r)&&(yield[s,r.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;for(const e of this.oldCache.keys())this.cache.has(e);return Math.min(this._size+0,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,s]of this.entriesAscending())e.call(t,s,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}const i=[239,187,191],a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let c;const l=new Uint8Array(16);function h(){if(!c&&(c="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!c))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(l)}const d=[];for(let e=0;e<256;++e)d.push((e+256).toString(16).slice(1));const u=function(e,t,n){if(a.randomUUID&&!t&&!e)return a.randomUUID();const s=(e=e||{}).random||(e.rng||h)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=s[e];return t}return function(e,t=0){return(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase()}(s)};var f,p=class extends Error{};f||(f={});var v=globalThis.fetch;var m=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;function y(e){return e&&m.test(e)}let g=(()=>{const e=localStorage.getItem("todos");try{return e?JSON.parse(e):[]}catch(e){return[]}})();const x={searchText:"",hideCompleted:!1},_=e=>{const t=document.createElement("div"),n=document.createElement("label"),s=document.createElement("input"),r=document.createElement("span"),o=document.createElement("button");return s.setAttribute("type","checkbox"),s.checked=e.completed,t.appendChild(s),s.addEventListener("change",(()=>{E(e.id),b(g),w(g,x)})),r.textContent=e.text,t.appendChild(r),n.classList.add("list-item"),t.classList.add("list-item__container"),n.appendChild(t),o.textContent="REMOVE",o.classList.add("button","button--text"),n.appendChild(o),o.addEventListener("click",(()=>{I(e.id),b(g),w(g,x)})),n},w=(e,t)=>{const n=e.filter((e=>{const n=e.text.toLowerCase().includes(t.searchText.toLowerCase()),s=!t.hideCompleted||!e.completed;return n&&s})),s=n.filter((e=>!e.completed));if(document.querySelector("#Todos").innerHTML="",document.querySelector("#Todos").appendChild((e=>{const t=document.createElement("h2");t.classList.add("list-title");let n="s";return 1===e.length&&(n=""),t.textContent=`You have ${e.length} todo${n} left`,t})(s)),n.length>0)n.forEach((e=>{document.querySelector("#Todos").appendChild(_(e))}));else{const e=document.createElement("p");e.classList.add("empty-message"),e.textContent="No items found for you to do",document.querySelector("#Todos").appendChild(e)}};w(g,x),document.querySelector("#search-text").addEventListener("input",(function(e){x.searchText=e.target.value,w(g,x)}));const b=e=>{localStorage.setItem("todos",JSON.stringify(e))};document.querySelector("#new-todo").addEventListener("submit",(function(e){const t=e.target.elements.text.value.trim();e.preventDefault(),t&&(g.push({id:uuid.v4(),text:t,completed:!1}),b(g),w(g,x),e.target.elements.text.value="")}));const E=e=>{const t=g.find((t=>t.id===e));t&&(t.completed=!t.completed)},I=e=>{const t=g.findIndex((t=>t.id===e));t>-1&&g.splice(t,1)};document.querySelector("#hide-completed").addEventListener("change",(function(e){x.hideCompleted=e.target.checked,w(g,x)}));const T=g.map((e=>e.text+","));document.getElementById("get-advice-btn").addEventListener("click",(async function(){const t=new class{constructor(e){const{accessToken:t,apiReverseProxyUrl:n="https://bypass.duti.tech/api/conversation",model:s="text-davinci-002-render-sha",debug:r=!1,headers:o,fetch:i=v}=e;if(this._accessToken=t,this._apiReverseProxyUrl=n,this._debug=!!r,this._model=s,this._fetch=i,this._headers=o,!this._accessToken)throw new Error("ChatGPT invalid accessToken");if(!this._fetch)throw new Error("Invalid environment; fetch is not defined");if("function"!=typeof this._fetch)throw new Error('Invalid "fetch" is not a function')}get accessToken(){return this._accessToken}set accessToken(e){this._accessToken=e}async sendMessage(t,n={}){if(!!n.conversationId!=!!n.parentMessageId)throw new Error("ChatGPTUnofficialProxyAPI.sendMessage: conversationId and parentMessageId must both be set or both be undefined");if(n.conversationId&&!y(n.conversationId))throw new Error("ChatGPTUnofficialProxyAPI.sendMessage: conversationId is not a valid v4 UUID");if(n.parentMessageId&&!y(n.parentMessageId))throw new Error("ChatGPTUnofficialProxyAPI.sendMessage: parentMessageId is not a valid v4 UUID");if(n.messageId&&!y(n.messageId))throw new Error("ChatGPTUnofficialProxyAPI.sendMessage: messageId is not a valid v4 UUID");const{conversationId:s,parentMessageId:o=u(),messageId:a=u(),action:c="next",timeoutMs:l,onProgress:h}=n;let{abortSignal:d}=n,f=null;l&&!d&&(f=new AbortController,d=f.signal);const m={action:c,messages:[{id:a,role:"user",content:{content_type:"text",parts:[t]}}],model:this._model,parent_message_id:o};s&&(m.conversation_id=s);const g={role:"assistant",id:u(),parentMessageId:a,conversationId:s,text:""},x=new Promise(((e,t)=>{const n=this._apiReverseProxyUrl,s={...this._headers,Authorization:`Bearer ${this._accessToken}`,Accept:"text/event-stream","Content-Type":"application/json"};this._debug&&console.log("POST",n,{body:m,headers:s}),async function(e,t,n=v){const{onMessage:s,...r}=t,o=await n(e,r);if(!o.ok){let e;try{e=await o.text()}catch(t){e=o.statusText}const t=`ChatGPT error ${o.status}: ${e}`,n=new p(t,{cause:o});throw n.statusCode=o.status,n.statusText=o.statusText,n}const a=function(e){let t,n,s,r,o,a,c;return l(),{feed:function(e){n=n?n+e:e,t&&function(e){return i.every(((t,n)=>e.charCodeAt(n)===t))}(n)&&(n=n.slice(i.length)),t=!1;const o=n.length;let a=0,c=!1;for(;a<o;){c&&("\n"===n[a]&&++a,c=!1);let e,t=-1,i=r;for(let r=s;t<0&&r<o;++r)e=n[r],":"===e&&i<0?i=r-a:"\r"===e?(c=!0,t=r-a):"\n"===e&&(t=r-a);if(t<0){s=o-a,r=i;break}s=0,r=-1,h(n,a,i,t),a+=t+1}a===o?n="":a>0&&(n=n.slice(a))},reset:l};function l(){t=!0,n="",s=0,r=-1,o=void 0,a=void 0,c=""}function h(t,n,s,r){if(0===r)return c.length>0&&(e({type:"event",id:o,event:a||void 0,data:c.slice(0,-1)}),c="",o=void 0),void(a=void 0);const i=s<0,l=t.slice(n,n+(i?r:s));let h=0;h=i?r:" "===t[n+s+1]?s+2:s+1;const d=n+h,u=r-h,f=t.slice(d,d+u).toString();if("data"===l)c+=f?"".concat(f,"\n"):"\n";else if("event"===l)a=f;else if("id"!==l||f.includes("\0")){if("retry"===l){const t=parseInt(f,10);Number.isNaN(t)||e({type:"reconnect-interval",value:t})}}else o=f}}((e=>{"event"===e.type&&s(e.data)}));if(o.body.getReader)for await(const e of async function*(e){const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)return;yield n}}finally{t.releaseLock()}}(o.body)){const t=(new TextDecoder).decode(e);a.feed(t)}else{const e=o.body;if(!e.on||!e.read)throw new p('unsupported "fetch" implementation');e.on("readable",(()=>{let t;for(;null!==(t=e.read());)a.feed(t.toString())}))}}(n,{method:"POST",headers:s,body:JSON.stringify(m),signal:d,onMessage:t=>{var n,s,r;if("[DONE]"===t)return e(g);try{const e=JSON.parse(t);e.conversation_id&&(g.conversationId=e.conversation_id),(null==(n=e.message)?void 0:n.id)&&(g.id=e.message.id);const o=e.message;if(o){let e=null==(r=null==(s=null==o?void 0:o.content)?void 0:s.parts)?void 0:r[0];e&&(g.text=e,h&&h(g))}}catch(e){}}},this._fetch).catch((n=>{const s=n.toString().toLowerCase();return!g.text||"error: typeerror: terminated"!==s&&"typeerror: terminated"!==s?t(n):e(g)}))}));return l?(f&&(x.cancel=()=>{f.abort()}),function(t,n){const{milliseconds:s,fallback:o,message:i,customTimers:a={setTimeout,clearTimeout}}=n;let c;const l=new Promise(((l,h)=>{if("number"!=typeof s||1!==Math.sign(s))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${s}\``);if(s===Number.POSITIVE_INFINITY)return void l(t);if(n.signal){const{signal:e}=n;e.aborted&&h(r(e)),e.addEventListener("abort",(()=>{h(r(e))}))}const d=new e;c=a.setTimeout.call(void 0,(()=>{if(o)try{l(o())}catch(e){h(e)}else"function"==typeof t.cancel&&t.cancel(),!1===i?l():i instanceof Error?h(i):(d.message=i??`Promise timed out after ${s} milliseconds`,h(d))}),s),(async()=>{try{l(await t)}catch(e){h(e)}finally{a.clearTimeout.call(void 0,c)}})()}));return l.clear=()=>{a.clearTimeout.call(void 0,c),c=void 0},l}(x,{milliseconds:l,message:"ChatGPT timed out waiting for response"})):x}}({accessToken:"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"}),n=await t.sendMessage("How are my tasks, "+T.join(", ")+"how can I finish in one week without procrastinating"),s=document.createElement("p");s.innerHTML=`Feedback: ${n.text}`,document.body.appendChild(s)}))})()})();